{% extends 'chamados/base.html' %}
{% block title %}Gerenciar Chamado #{{ chamado.id }}{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-7">
        <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2">
            <h1 class="h2 mb-0">Gerenciar Chamado #{{ chamado.id }}</h1>
            <div>
                <span id="texto-para-copiar-{{ chamado.id }}" class="d-none">{{ chamado.get_whatsapp_message }}</span>
                <button class="btn btn-sm btn-info btn-copy" data-chamado-id="{{ chamado.id }}" title="Copiar Detalhes">
                    <i class="fas fa-copy"></i> Copiar
                </button>
                <a href="{% url 'painel' %}" class="btn btn-sm btn-secondary">Voltar ao Painel</a>
            </div>
        </div>
        
        </div>
    </div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Adiciona o evento de clique a TODOS os botÃµes de copiar
    document.querySelectorAll('.btn-copy').forEach(button => {
        button.addEventListener('click', function() {
            const chamadoId = this.getAttribute('data-chamado-id');
            const textoParaCopiar = document.getElementById(`texto-para-copiar-${chamadoId}`).textContent;
            
            navigator.clipboard.writeText(textoParaCopiar.trim()).then(() => {
                const originalText = this.innerHTML;
                this.innerHTML = '<i class="fas fa-check"></i> Copiado!';
                setTimeout(() => { this.innerHTML = originalText; }, 2000);
            }, (err) => {
                console.error('Falha ao copiar texto: ', err);
            });
        });
    });
});
</script>
{% endblock %}